<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-type" content="text/html; charset=utf-8">
        <title>Breakout - A fast fun game</title>
        <script src="./bower_components/jquery/dist/jquery.min.js"></script>
        <link rel="stylesheet" type="text/css" href="./css/breakout_style.css">
    </head>
    <body>    
        <div id="game">
            <input name="name" type="hidden" value="Lotte">
            <div style="display:none;">
                <img src="./img/breakout_background.jpg">
            </div>
            <div class="topBar">
                <div id="score">X<span class="number">0</span></div>
                <div id="time"><img src="./img/klokje.png"> <span><span class="seconds">00.0</span></span></div>
            </div>
            
            <canvas id="canvas" width="799" height="595"> 
              Your browser does not support the HTML5 Canvas feature. This game uses new HTML5 features and will only work on the latest versions of Firefox, Safari or Chrome (and maybe Internet Explorer 9).         
            </canvas>
            <div class="overlay" id="startOverlay" style="display:block;">
                <p>
                    Beweeg je <span>computermuis</span> als je op<br>
                    een computer speelt of gebruik <br>
                    je <span>vingers</span> als je op tablet speelt.<br>
                    <img src="./img/mouse_or_swipe.png">
                </p>
                 
                <a id="startButton">Klaar? start!</a>
            </div>
            <div class="overlay" id="wonOverlay" style="display:none;">
                <p>
                    Goed zo! je hebt alle gouden Cocos <br>
                    verzameld. Dit is jouw tijd:
                </p>
                <p id="finalScore"></p>
                <a id="sendScoreButton" class="doubleLine">
                    Verstuur je score<br>
                    <span>(een code kan maar éénmaal gebruikt worden)</span>
                </a>
                <a id="practiceButton" class="breakout-btn breakout-btn-green">Nog even oefenen?</a>
                <hr>
                <a id="practiceWhitoutButton" class="red">Oefenen zonder code</a>
            </div>
            <div class="overlay" id="gameOverOverlay" style="display:none;">
                <p>
                    Game over!
                </p>
                <a id="practiceButton">Nog even oefenen?</a>
                <hr>
                <a id="practiceWhitoutButton" class="red">Oefenen zonder code</a>
            </div>
        </div>
        
        
        <script type="text/javascript" src="./js/breakout.js"></script>
        <script type="text/javascript">
            $(function () {
                var contestantName = $('input[name="name"]').val();
                var game = $('#canvas').breakout({name:contestantName});
                $('#startButton').click(function(){
                    $(this).closest('.overlay').fadeOut(200);
                    setTimeout(function () {
                        game.startGame();
                    },400);
                });
                $('#canvas').on('gameOver',function (e,result){
                    $('#gameOverOverlay').show();
                    showLives(0,3);
                });
                $('#canvas').on('lostLive',function (e,result){
                    console.log(result);
                    showLives(result.lives,3);
                });
                $('#canvas').on('score',function (e,result){
                    console.log(result);
                    $('#score span').text(result.score);
                });
                $('#canvas').on('won',function (e,result){
                    console.log(result);
                    $('#wonOverlay').show();
                    $('#finalScore').html(result.elapsedTime.clock);
                    $time.html(result.elapsedTime.clock);
                });

                var $time = $('#time span');
                $('#canvas').on('timeUpdate',function (e,result){
                    $time.html(result.elapsedTime.clock);
                });

                function showLives(livesLeft,lives) {
                    for (var i = 0; i < lives; i++) {
                        if (i >= livesLeft) {
                            console.log('dood');
                        } else {
                            console.log('leven');
                        }
                    }
                }

                showLives(3,3);
            });
        </script>
    </body>
</html>