var CryptoJS=CryptoJS||function(t,e){var i={},n=i.lib={},a=function(){},r=n.Base={extend:function(t){a.prototype=this;var e=new a;return t&&e.mixIn(t),e.hasOwnProperty("init")||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},o=n.WordArray=r.extend({init:function(t,i){t=this.words=t||[],this.sigBytes=i!=e?i:4*t.length},toString:function(t){return(t||l).stringify(this)},concat:function(t){var e=this.words,i=t.words,n=this.sigBytes;if(t=t.sigBytes,this.clamp(),n%4)for(var a=0;t>a;a++)e[n+a>>>2]|=(i[a>>>2]>>>24-8*(a%4)&255)<<24-8*((n+a)%4);else if(65535<i.length)for(a=0;t>a;a+=4)e[n+a>>>2]=i[a>>>2];else e.push.apply(e,i);return this.sigBytes+=t,this},clamp:function(){var e=this.words,i=this.sigBytes;e[i>>>2]&=4294967295<<32-8*(i%4),e.length=t.ceil(i/4)},clone:function(){var t=r.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var i=[],n=0;e>n;n+=4)i.push(4294967296*t.random()|0);return new o.init(i,e)}}),s=i.enc={},l=s.Hex={stringify:function(t){var e=t.words;t=t.sigBytes;for(var i=[],n=0;t>n;n++){var a=e[n>>>2]>>>24-8*(n%4)&255;i.push((a>>>4).toString(16)),i.push((15&a).toString(16))}return i.join("")},parse:function(t){for(var e=t.length,i=[],n=0;e>n;n+=2)i[n>>>3]|=parseInt(t.substr(n,2),16)<<24-4*(n%8);return new o.init(i,e/2)}},c=s.Latin1={stringify:function(t){var e=t.words;t=t.sigBytes;for(var i=[],n=0;t>n;n++)i.push(String.fromCharCode(e[n>>>2]>>>24-8*(n%4)&255));return i.join("")},parse:function(t){for(var e=t.length,i=[],n=0;e>n;n++)i[n>>>2]|=(255&t.charCodeAt(n))<<24-8*(n%4);return new o.init(i,e)}},h=s.Utf8={stringify:function(t){try{return decodeURIComponent(escape(c.stringify(t)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(t){return c.parse(unescape(encodeURIComponent(t)))}},u=n.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=h.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var i=this._data,n=i.words,a=i.sigBytes,r=this.blockSize,s=a/(4*r),s=e?t.ceil(s):t.max((0|s)-this._minBufferSize,0);if(e=s*r,a=t.min(4*e,a),e){for(var l=0;e>l;l+=r)this._doProcessBlock(n,l);l=n.splice(0,e),i.sigBytes-=a}return new o.init(l,a)},clone:function(){var t=r.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});n.Hasher=u.extend({cfg:r.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,i){return new t.init(i).finalize(e)}},_createHmacHelper:function(t){return function(e,i){return new d.HMAC.init(t,i).finalize(e)}}});var d=i.algo={};return i}(Math);!function(t){var e=CryptoJS,i=e.lib,n=i.Base,a=i.WordArray,e=e.x64={};e.Word=n.extend({init:function(t,e){this.high=t,this.low=e}}),e.WordArray=n.extend({init:function(e,i){e=this.words=e||[],this.sigBytes=i!=t?i:8*e.length},toX32:function(){for(var t=this.words,e=t.length,i=[],n=0;e>n;n++){var r=t[n];i.push(r.high),i.push(r.low)}return a.create(i,this.sigBytes)},clone:function(){for(var t=n.clone.call(this),e=t.words=this.words.slice(0),i=e.length,a=0;i>a;a++)e[a]=e[a].clone();return t}})}(),function(){function t(){return a.create.apply(a,arguments)}for(var e=CryptoJS,i=e.lib.Hasher,n=e.x64,a=n.Word,r=n.WordArray,n=e.algo,o=[t(1116352408,3609767458),t(1899447441,602891725),t(3049323471,3964484399),t(3921009573,2173295548),t(961987163,4081628472),t(1508970993,3053834265),t(2453635748,2937671579),t(2870763221,3664609560),t(3624381080,2734883394),t(310598401,1164996542),t(607225278,1323610764),t(1426881987,3590304994),t(1925078388,4068182383),t(2162078206,991336113),t(2614888103,633803317),t(3248222580,3479774868),t(3835390401,2666613458),t(4022224774,944711139),t(264347078,2341262773),t(604807628,2007800933),t(770255983,1495990901),t(1249150122,1856431235),t(1555081692,3175218132),t(1996064986,2198950837),t(2554220882,3999719339),t(2821834349,766784016),t(2952996808,2566594879),t(3210313671,3203337956),t(3336571891,1034457026),t(3584528711,2466948901),t(113926993,3758326383),t(338241895,168717936),t(666307205,1188179964),t(773529912,1546045734),t(1294757372,1522805485),t(1396182291,2643833823),t(1695183700,2343527390),t(1986661051,1014477480),t(2177026350,1206759142),t(2456956037,344077627),t(2730485921,1290863460),t(2820302411,3158454273),t(3259730800,3505952657),t(3345764771,106217008),t(3516065817,3606008344),t(3600352804,1432725776),t(4094571909,1467031594),t(275423344,851169720),t(430227734,3100823752),t(506948616,1363258195),t(659060556,3750685593),t(883997877,3785050280),t(958139571,3318307427),t(1322822218,3812723403),t(1537002063,2003034995),t(1747873779,3602036899),t(1955562222,1575990012),t(2024104815,1125592928),t(2227730452,2716904306),t(2361852424,442776044),t(2428436474,593698344),t(2756734187,3733110249),t(3204031479,2999351573),t(3329325298,3815920427),t(3391569614,3928383900),t(3515267271,566280711),t(3940187606,3454069534),t(4118630271,4000239992),t(116418474,1914138554),t(174292421,2731055270),t(289380356,3203993006),t(460393269,320620315),t(685471733,587496836),t(852142971,1086792851),t(1017036298,365543100),t(1126000580,2618297676),t(1288033470,3409855158),t(1501505948,4234509866),t(1607167915,987167468),t(1816402316,1246189591)],s=[],l=0;80>l;l++)s[l]=t();n=n.SHA512=i.extend({_doReset:function(){this._hash=new r.init([new a.init(1779033703,4089235720),new a.init(3144134277,2227873595),new a.init(1013904242,4271175723),new a.init(2773480762,1595750129),new a.init(1359893119,2917565137),new a.init(2600822924,725511199),new a.init(528734635,4215389547),new a.init(1541459225,327033209)])},_doProcessBlock:function(t,e){for(var i=this._hash.words,n=i[0],a=i[1],r=i[2],l=i[3],c=i[4],h=i[5],u=i[6],i=i[7],d=n.high,g=n.low,f=a.high,p=a.low,m=r.high,v=r.low,b=l.high,w=l.low,k=c.high,y=c.low,$=h.high,_=h.low,B=u.high,I=u.low,S=i.high,R=i.low,x=d,H=g,W=f,T=p,L=m,A=v,C=b,D=w,M=k,z=y,O=$,X=_,Y=B,P=I,J=S,U=R,F=0;80>F;F++){var G=s[F];if(16>F)var j=G.high=0|t[e+2*F],E=G.low=0|t[e+2*F+1];else{var j=s[F-15],E=j.high,q=j.low,j=(E>>>1|q<<31)^(E>>>8|q<<24)^E>>>7,q=(q>>>1|E<<31)^(q>>>8|E<<24)^(q>>>7|E<<25),K=s[F-2],E=K.high,N=K.low,K=(E>>>19|N<<13)^(E<<3|N>>>29)^E>>>6,N=(N>>>19|E<<13)^(N<<3|E>>>29)^(N>>>6|E<<26),E=s[F-7],Q=E.high,V=s[F-16],Z=V.high,V=V.low,E=q+E.low,j=j+Q+(q>>>0>E>>>0?1:0),E=E+N,j=j+K+(N>>>0>E>>>0?1:0),E=E+V,j=j+Z+(V>>>0>E>>>0?1:0);G.high=j,G.low=E}var Q=M&O^~M&Y,V=z&X^~z&P,G=x&W^x&L^W&L,te=H&T^H&A^T&A,q=(x>>>28|H<<4)^(x<<30|H>>>2)^(x<<25|H>>>7),K=(H>>>28|x<<4)^(H<<30|x>>>2)^(H<<25|x>>>7),N=o[F],ee=N.high,ie=N.low,N=U+((z>>>14|M<<18)^(z>>>18|M<<14)^(z<<23|M>>>9)),Z=J+((M>>>14|z<<18)^(M>>>18|z<<14)^(M<<23|z>>>9))+(U>>>0>N>>>0?1:0),N=N+V,Z=Z+Q+(V>>>0>N>>>0?1:0),N=N+ie,Z=Z+ee+(ie>>>0>N>>>0?1:0),N=N+E,Z=Z+j+(E>>>0>N>>>0?1:0),E=K+te,G=q+G+(K>>>0>E>>>0?1:0),J=Y,U=P,Y=O,P=X,O=M,X=z,z=D+N|0,M=C+Z+(D>>>0>z>>>0?1:0)|0,C=L,D=A,L=W,A=T,W=x,T=H,H=N+E|0,x=Z+G+(N>>>0>H>>>0?1:0)|0}g=n.low=g+H,n.high=d+x+(H>>>0>g>>>0?1:0),p=a.low=p+T,a.high=f+W+(T>>>0>p>>>0?1:0),v=r.low=v+A,r.high=m+L+(A>>>0>v>>>0?1:0),w=l.low=w+D,l.high=b+C+(D>>>0>w>>>0?1:0),y=c.low=y+z,c.high=k+M+(z>>>0>y>>>0?1:0),_=h.low=_+X,h.high=$+O+(X>>>0>_>>>0?1:0),I=u.low=I+P,u.high=B+Y+(P>>>0>I>>>0?1:0),R=i.low=R+U,i.high=S+J+(U>>>0>R>>>0?1:0)},_doFinalize:function(){var t=this._data,e=t.words,i=8*this._nDataBytes,n=8*t.sigBytes;return e[n>>>5]|=128<<24-n%32,e[(n+128>>>10<<5)+30]=Math.floor(i/4294967296),e[(n+128>>>10<<5)+31]=i,t.sigBytes=4*e.length,this._process(),this._hash.toX32()},clone:function(){var t=i.clone.call(this);return t._hash=this._hash.clone(),t},blockSize:32}),e.SHA512=i._createHelper(n),e.HmacSHA512=i._createHmacHelper(n)}(),$.extend($.fn,{breakout:function(t){function e(){i(),L.bricksPerRow=L.bricksLayout[0].length,L.bricksWidth=(A.width-20)/L.bricksPerRow,Y=L.ballX,P=L.ballY,R=L.paddleX-L.paddleWidth/2,U=L.paddleDeltaX,f(),n(),o(),l(),a(),g(),p(),document.onmousemove=function(t){x=t.pageX-M,H=t.pageY}}function i(){for(var t=0;t<L.bricksTypes.length;t++)for(var e=0;e<L.bricksTypes[t].length;e++)L.bricksTypes[t][e]=_(1,4)}function n(){switch(L.paddleType){case"rectangle":D.drawImage(E,R,L.paddleY),D.font="12px cocon",D.textAlign="right",D.fillStyle="rgba(0,0,0,0.4)",D.fillText(L.name,R+L.paddleWidth-8,L.paddleY+30)}}function a(){D.font="normal 18pt cocon",D.textAlign="left",D.fillStyle="#d40038",D.fillText(L.name+":",165,575)}function r(){if(J){var t=L.paddleWidth/2;U=x>R?(x-t-R)/5:R>x?(x-t-R)/5:0,(0>R+U||R+U+L.paddleWidth>A.width)&&(U=0),R+=U}}function o(){D.drawImage(G,Y-16,P-16)}function s(){if((P+X-L.ballRadius+16<0||d())&&(X=-X),(Y+O-L.ballRadius+16<0||Y+O+L.ballRadius+16>A.width||u())&&(O=-O),P+X+L.ballRadius-16>A.height&&(L.lives--,L.lives?(b(),C.trigger("lostLive",[{lives:L.lives}])):w()),P+X+L.ballRadius+16>=L.paddleY+L.paddleHeight/2&&P+X+L.ballRadius+16<=L.paddleY+L.paddleHeight/2+X+1&&Y+O+16>=R&&Y+O+16<=R+L.paddleWidth){X=-X;var t=(Y+O+16-R-L.paddleWidth/2)/35;O+=t}O=O>Math.abs(X)+1?Math.abs(X)+1:O<-Math.abs(X)-1?-Math.abs(X)-1:O,Y+=O,P+=X}function l(){W=0;for(var t=0;t<L.bricksLayout.length;t++)for(var e=0;e<L.bricksLayout[t].length;e++){var i=L.bricksLayout[t][e];c(e,t,i),3===i&&W++}}function c(t,e,i){if(i>0&&3>i){var n;switch(L.bricksTypes[e][t]){case 1:n=0;break;case 2:n=80;break;case 3:n=160;break;case 4:n=240}D.drawImage(q,n,0,80,72,t*L.bricksWidth+10,55*e,L.bricksWidth,80/L.bricksWidth*72)}else 3==i&&D.drawImage(q,320,0,80,72,t*((A.width-40)/10)+10,55*e,80,72)}function h(t,e){$(A).trigger("hitBrick",[]);var i=L.bricksLayout[t][e]--;3===i&&(z++,L.bricksLayout[t][e]=0,C.trigger("score",[{score:z}]),5===z&&k()),X-=.1}function u(){for(var t=!1,e=0;e<L.bricksLayout.length;e++)for(var i=0;i<L.bricksLayout[e].length;i++)if(L.bricksLayout[e][i]){var n=i*L.bricksWidth,a=e*L.bricksHeight;(Y+O+L.ballRadius-16>=n&&Y+L.ballRadius-16<=n||Y+O-L.ballRadius+16<=n+L.bricksWidth&&Y-L.ballRadius+16>=n+L.bricksWidth)&&P+X-L.ballRadius+16<=a+L.bricksHeight&&P+X+L.ballRadius-16>=a&&(h(e,i),t=!0)}return t}function d(){for(var t=!1,e=0;e<L.bricksLayout.length;e++)for(var i=0;i<L.bricksLayout[e].length;i++)if(L.bricksLayout[e][i]){var n=i*L.bricksWidth,a=e*L.bricksHeight;(P+X-L.ballRadius+16<=a+L.bricksHeight&&P-L.ballRadius+16>=a+L.bricksHeight||P+X+L.ballRadius-16>=a&&P+L.ballRadiu-16<=a)&&Y+O+L.ballRadius-16>=n&&Y+O-L.ballRadius+16<=n+L.bricksWidth&&(h(e,i),t=!0)}return t}function g(){for(var t=A.height-48,e=2;e>=0;e--)L.lives>e?D.drawImage(j,0,0,44,38,A.width/2+100+44*e,t,44,38):D.drawImage(j,48,0,40,38,A.width/2+100+44*e,t,40,38)}function f(){D.clearRect(0,0,A.width,A.height),D.drawImage(F,0,0)}function p(){D.fillStyle="rgba(0,0,0,0.5)",D.fillRect(0,0,A.width,A.height)}function m(){f(),l(),s(),r(),n(),o(),g(),a(),C.trigger("timeUpdate",[{elapsedTime:y(new Date-B)}])}function v(){X=-4,O=_(-2,2),J=!1,U=0,f(),l(),n(),o(),g(),a(),setTimeout(function(){B=new Date,S=setInterval(m,20)},500),$(A).mousedown(function(){J=!0}),$(document).mouseup(function(){J=!1})}function b(){Y=A.width/2,P=A.height/3*2,X=0,O=0,setTimeout(function(){X=-4,O=_(-2,2)},1e3)}function w(){I=new Date-B,clearInterval(S),$(A).trigger("gameOver",[]),p(),setTimeout(function(){p()},30)}function k(){I=new Date-B,clearInterval(S),$(A).trigger("won",[{elapsedTime:y(I),time:I}]),p(),setTimeout(function(){p()},30)}function y(t){var e=t%1e3,i=(t-e)/1e3,n=i%60,a=Math.round(e/10),r=~~(i/60);return{minutes:r,seconds:n,milliseconds:a,clock:0===n?'<span class="seconds">0:00.</span>'+a:'<span class="seconds">'+r+":"+("0"+n).slice(-2)+".</span>"+a}}function _(t,e){return Math.floor(Math.random()*(e-t+1))+t}var B,I,S,R,x,H,W,T={paddleType:"rectangle",paddleX:200,paddleY:430,paddleWidth:246,paddleHeight:53,paddleDeltaX:0,paddleDeltaY:0,paddleColor:"rgb(0,0,0)",ballX:400,ballY:340,ballRadius:12,ballColor:"rgb(0,0,0)",bricksPerRow:10,bricksHeight:55,bricksWidth:0,bricksLayout:[[1,1,1,1,1,1,3,1,1,1],[1,1,3,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,3,1,1],[1,1,1,3,1,1,1,1,1,1],[1,1,3,1,1,1,1,1,1,1]],bricksTypes:[[1,1,1,1,1,1,3,1,1,1],[1,1,3,1,1,1,1,1,1,1],[1,1,1,1,1,2,1,3,1,1],[1,1,1,3,1,1,1,1,1,1],[1,1,3,1,1,1,1,1,1,1]],lives:3},L=$.extend(!0,{},T,t),A=this[0],C=$(A),D=A.getContext("2d"),M=C.offset().left,z=0,O=0,X=0,Y=0,P=0,J=!1,U=0,F=L.backgroundImage;F.onload=function(){e()};var G=L.ballImage,j=L.livesImage,E=L.spoonImage,q=L.popsImage;return q.onload=function(){e()},e(),$.extend({startGame:function(){v()},getElapsedTime:function(){return new Date-B},restart:function(){L.bricksLayout=T.bricksLayout,L.lives=T.lives,e(),v()}})}}),$(function(){$.marap={};var t=$('input[name="name"]').val();ga("send","event","breakout-game","load-game",t);var e=$("#canvas").breakout({name:t,backgroundImage:$("#backgroundImage")[0],ballImage:$("#ballImage")[0],livesImage:$("#livesImage")[0],spoonImage:$("#spoonImage")[0],popsImage:$("#popsImage")[0]});$("#startButton").click(function(){ga("send","event","breakout-game","start-game"),$(this).closest(".overlay").fadeOut(200),setTimeout(function(){e.startGame()},400)}),$("#canvas").on("gameOver",function(){$("#gameOverOverlay").show(),ga("send","event","breakout-game","game-over")}),$("#canvas").on("lostLive",function(){ga("send","event","breakout-game","lost-live")}),$("#canvas").on("score",function(t,e){ga("send","event","breakout-game","score-game"),$("#score span").text(e.score)});var i=$("#time span");$("#canvas").on("won",function(t,e){ga("send","event","breakout-game","won-game"),$.marap=e;var n="kellogsActie";$("#wonOverlay").show(),$("#finalScore").html(e.elapsedTime.clock),i.html(e.elapsedTime.clock),$('input[name="clicks"]').val(0),$('input[name="time"]').val(e.time);var a=CryptoJS.SHA512(n),r=CryptoJS.SHA512("0/"+$.marap.time+a);$('input[name="token"]').val(r.toString()),ga("send","event","breakout-game","score","time",e.time)}),$("#sendScoreButton").click(function(){$(".play-button").click(),ga("send","event","breakout-game","send-score")}),$("#canvas").on("timeUpdate",function(t,e){i.html(e.elapsedTime.clock)}),$("#canvas").on("hitBrick",function(){ga("send","event","breakout-game","hitBrick")}),$(".restartGame").click(function(t){t.preventDefault(),e.restart(),$(t.target).closest(".overlay").hide(),ga("send","event","breakout-game","restart-game")})});